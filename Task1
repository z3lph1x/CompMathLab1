#include <cmath>
#include <iostream>
#include <vector>
#include<fstream>

using namespace std;
using std::cout;
double pi = 3.141592653589793238;

double IE(double x, double L) {
    return sin(4 * pi * x / L);
}

double LeftAngle(double Umn, double Um_1n, double tau, double h) {
    return Umn + (Um_1n - Umn) * h / tau;
}

int main() {
    double L = 20;
    double T = 18;
    double h = 0.5;
    double Co = 0.6;
    double tau = Co * h;
    int Nx = L / h + 1;
    int Nt = T / tau + 1;
    vector<double> u;
    u.resize(int((Nx) * (Nt)));
    for (int i = 0; i < Nx; i++) {
        u[i] = IE(h * i, L);
    }
    for (int i = 1; i < Nt; i++) {
        for (int j = 1; j < Nx; j++) {
            u[Nx * i + j] = LeftAngle(u[Nx * (i - 1) + j], u[Nx * (i - 1) + j - 1], tau, h);
        }
        u[Nx * i] = u[Nx * (i + 1) - 1];
    }
    double A[int(Nt)][int(Nx)];
    for (int i = 0; i < Nt; i++) {
        for (int j = 0; j < Nx; j++) {
            A[i][j] = u[Nt * i + j];
        }
    }
    cout << u[40] << ' ' << A[39][59];

    //ofstream out("LA06.txt");
    //for (int x = 0; x < Nx; x++) {
      //  for (int y = 0; y < Nt; y++) {
//
  //          out << A[x][y]<<' ';
    //    }
      //  out << "\n";
    //}

}
